<% provide(:title, 'Vote in poll #' + @poll.id.to_s) %>

<div class="container">

  <% if @poll.poll_is_over? %>
    <div class="alert alert-danger">Poll is closed</div>
  <% elsif !@poll.confirmed %>
    <div class="alert-alert-danger">Voting is not open</div>
  <% else %>

    <h3><%=md @poll.question %></h3>

    <% if !@vote.new_record? %>
      <div class="alert alert-warning"><p>You have already voted for this poll!</p><p>You can edit your vote below</p></div>
    <% end %>

    <%= simple_form_for @vote do |f| %>
      <%= f.input :poll_id, :as => :hidden, :input_html => { :value => @poll.id } %>

      <% if @poll.multiple %>
        <%= f.association :poll_options, label: false, class: 'form-control', collection: @poll.poll_options, as: :check_boxes, label_method: :description, value_method: :id %>
      <% else %>
        <%#= f.association :poll_options, label: false, class: 'form-control', collection: @poll.poll_options, as: :multiple_radio_buttons, label_method: :description, value_method: :id %>
        <% @poll.poll_options.each do |option| %>
          <span class="radio">
            <label>
              <input class="radio_buttons optional" name="vote[poll_option_ids][]" type="radio" value="<%= option.id %>" <%= option.in?(@vote.poll_options) ? "checked=checked" : "" %> />
              <%= option.description %>
            </label>
          </span>
        <% end %>
      <% end %>


      <%= f.input :comment, required: false %>

      <button type="submit" class="btn btn-success">
      <%= !@vote.new_record? ? "Update vote" : "Vote" %>
      </button>

    <% end %>

  <% end %>
  <%= link_to 'Back to Polls', polls_path, class: "polls-home" %>
</div>
